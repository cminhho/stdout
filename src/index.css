/* Fonts: system stack only so the app runs fully offline (no Google Fonts). */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /*
   * Theme tokens: WCAG AA contrast, semantic layers, single primary hue.
   * Dark: slate-tinted neutrals (224°). Light: warm neutrals (25°). Deep dark: true neutrals (0°).
   * Primary: blue 221 83% 53% (works on light/dark). Code syntax: VS Code–style.
   *
   * Token hierarchy (reuse; avoid redefining):
   * - Spacing: --home-space-2xs|xs|sm|md|lg|xl|2xl (8px grid); --home-space-inner (12px), --home-space-stack (6px) for tight layout; --spacing-* alias where semantic.
   * - Radius: --radius, --radius-sm, --radius-item, --home-radius-card; --settings-window-radius (mobile sheet).
   * - Motion: --transition-duration, --transition-ease; --transition-default = both; --transition-duration-slow (e.g. body/theme).
   * - Focus: --focus-ring, --focus-ring-sidebar (single box-shadow token for all focus-visible).
   * - Scrollbar: --scrollbar-thumb, --scrollbar-thumb-hover per theme (desktop thin scrollbars).
   * - Typography: --text-nav|ui|content|caption|title|hero (hero = 1.125rem for taglines/section titles).
   * - Glass: --glass-edge, --glass-highlight-color; --glass-blur/--glass-saturate (title-bar/sidebar); --glass-blur-subtle/--glass-saturate-subtle (cards); --glass-blur-sidebar/--glass-saturate-sidebar (settings sidebar).
   * - Settings: --settings-sidebar-width, --settings-window-radius.
   * - Aliases (reuse, single source): --popover = --card; --accent = --primary; --segment-bg = --muted, --segment-border = --border; --sidebar-active-border = --sidebar-primary.
   * - Tables: cell padding = var(--home-space-sm) var(--home-space-md); thead/row hover semantic per context.
   */
  :root,
  .dark {
    color-scheme: dark;
    /* Base: slate-800 style, foreground ≥ 4.5:1 on background */
    --background: 224 13% 17%;
    --foreground: 210 40% 98%;

    --card: 224 13% 20%;
    --card-foreground: 210 40% 98%;

    --popover: var(--card);
    --popover-foreground: var(--card-foreground);

    /* Primary: blue-600 style, 4.5:1 on white and on dark bg */
    --primary: 221 83% 53%;
    --primary-foreground: 0 0% 100%;

    --secondary: 215 14% 26%;
    --secondary-foreground: 210 40% 98%;

    --muted: 215 14% 26%;
    --muted-foreground: 215 9% 58%;

    --accent: var(--primary);
    --accent-foreground: var(--primary-foreground);

    --destructive: 0 72% 51%;
    --destructive-foreground: 0 0% 100%;

    --border: 216 12% 24%;
    --input: 216 12% 21%;
    --input-bg: 224 13% 18%;           /* VS Code input surface (slightly elevated from panel) */
    --segment-bg: var(--muted);
    --segment-border: var(--border);
    --ring: 221 83% 53%;

    --radius: 0.625rem;

    --sidebar-background: 224 13% 14%;
    --sidebar-foreground: 210 40% 98%;
    --sidebar-primary: 221 83% 53%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 215 14% 24%;
    --sidebar-accent-foreground: 210 40% 98%;
    --sidebar-border: 216 12% 22%;
    --sidebar-ring: 221 83% 53%;
    --sidebar-active-border: var(--sidebar-primary);

    --header-bg: 224 13% 15%;
    --header-tab-bg: 215 14% 24%;

    /* Code: VS Code–style syntax, sufficient contrast */
    --code-bg: 224 13% 14%;
    --code-border: 216 12% 22%;
    --code-text: 210 40% 96%;
    --code-key: 210 40% 92%;
    --code-string: 142 69% 58%;
    --code-number: 31 92% 50%;
    --code-boolean: 258 90% 66%;
    --code-null: 258 90% 66%;
    --code-bracket: 215 9% 62%;
    --code-punctuation: 215 9% 62%;
    --code-comment: 215 9% 48%;
    --code-tag: 0 70% 65%;           /* HTML/XML tag name (VS Code–style) */
    /* Random string view: digit / upper / lower / symbol (industry practice: distinct, scannable) */
    --code-rs-digit: 38 92% 55%;     /* amber – digits */
    --code-rs-upper: 199 89% 48%;   /* cyan – uppercase */
    --code-rs-lower: 142 69% 58%;   /* green – lowercase */
    --code-rs-symbol: 215 9% 58%;   /* muted – symbols */
    --code-gutter-foreground: 215 9% 48%; /* line number gutter (muted) */
    --code-line-height: 1.5;         /* unitless, editor line height */
    --code-font-size: var(--text-content);      /* 14px */
    --code-gutter-min-width: 36px;   /* min width of line number column */

    --outline-button-bg: 215 14% 24%;
    --outline-button-border: 216 12% 32%;
    --outline-button-foreground: 210 40% 98%;

    --font-mono: ui-monospace, 'SF Mono', 'Cascadia Code', 'Consolas', monospace;
    --font-sans: system-ui, -apple-system, 'Segoe UI', sans-serif;
    /* Typography scale (across pages, macOS-style) */
    --text-nav: 0.75rem;
    --text-ui: 0.8125rem;
    --text-content: 0.875rem;
    --text-caption: 0.6875rem;   /* 11px – labels, badges, compact UI */
    --text-title: 1.0625rem;     /* 17px – panel/section titles */
    /* Responsive: breakpoints align with Tailwind (sm 640px, md 768px, lg 1024px) */
    --bp-sm: 640px;
    --bp-md: 768px;
    --bp-lg: 1024px;
    /*
     * Layout spacing: 8px base grid (VS Code / industry).
     * Scale: 4(0.25) 8(0.5) 12(0.75) 16(1) 20(1.25) 24(1.5) 32(2).
     */
    --spacing-content-x: 1.25rem;   /* 20px */
    --spacing-content-y: 1rem;      /* 16px */
    --spacing-content-x-md: 1.5rem; /* 24px @ md */
    --spacing-content-y-md: 1.25rem;
    --spacing-panel-gap: var(--home-space-sm);    /* 8px between panel header and body */
    --spacing-panel-inner-x: var(--home-space-md);     /* 16px horizontal padding inside each pane */
    --spacing-panel-inner-y: var(--home-space-inner);  /* 12px vertical padding inside pane body */
    --spacing-panel-resizer-gap: var(--home-space-sm); /* 8px between pane content and resizer */
    --spacing-toolbar-mb: var(--home-space-sm);   /* 8px below toolbar */
    --spacing-title-mb: var(--home-space-sm);     /* 8px below page title */
    --spacing-section-mb: var(--home-space-sm);   /* 8px between sections */
    --spacing-block-gap: var(--home-space-sm);    /* 8px between inline blocks */
    --spacing-code-editor: var(--home-space-inner);
    --spacing-grid-gap: var(--home-space-sm);    /* 8px grid/flex gap */
    --spacing-tool-layout-x: var(--home-space-sm);  /* 8px horizontal padding for tool layout */
    /* Home hub: system design scale (8px grid, industry + macOS) */
    --home-space-xs: 0.25rem;   /* 4px */
    --home-space-sm: 0.5rem;   /* 8px */
    --home-space-md: 1rem;     /* 16px */
    --home-space-lg: 1.5rem;   /* 24px */
    --home-space-xl: 2rem;     /* 32px */
    --home-space-2xl: 2.5rem;  /* 40px */
    --home-radius-card: 0.5rem;      /* 8px – macOS-style card radius */
    --home-card-height: 8rem;        /* 128px – 8px grid */
    --home-content-max-width: 64rem;
    --home-content-gap: var(--home-space-lg);
    --home-tools-header-gap: var(--home-space-sm);
    --home-footer-padding-y: var(--home-space-xl);
    --home-footer-padding-y-md: var(--home-space-2xl);
    --min-touch: 44px; /* Apple/Google minimum touch target */
    /* Radius scale (macOS-style: card 8px, small 4px, item 6px) */
    --radius-sm: 0.25rem;   /* 4px – scrollbar thumb, small chips */
    --radius-item: 0.375rem; /* 6px – list/item pill (settings category, etc.) */
    /* Shorthand: use in transition properties to avoid repeating duration/ease */
    --transition-default: var(--transition-duration) var(--transition-ease);
    --transition-duration-slow: 0.2s;   /* theme/body color transition */
    /* Focus ring: single token for all focus-visible (panel-resizer, settings-tab, etc.) */
    --focus-ring: 0 0 0 2px hsl(var(--ring));
    --focus-ring-sidebar: 0 0 0 2px hsl(var(--sidebar-ring));
    /* Scrollbar (desktop): thumb color so one place to theme */
    --scrollbar-thumb: hsl(0 0% 50% / 0.4);
    --scrollbar-thumb-hover: hsl(0 0% 50% / 0.55);
    /* Typography: hero/section title (18px) */
    --text-hero: 1.125rem;
    /* Softer glass for cards/panels (24px blur vs 44px for title-bar/sidebar) */
    --glass-blur-subtle: 24px;
    --glass-saturate-subtle: 160%;
    /* Settings sidebar vibrancy (slightly softer than main glass) */
    --glass-blur-sidebar: 20px;
    --glass-saturate-sidebar: 130%;
    /* Extra-tight gap (2px) for list items */
    --home-space-2xs: 0.125rem;
    /* 12px / 6px – off 8px grid for tight panel/content spacing */
    --home-space-inner: 0.75rem;
    --home-space-stack: 0.375rem;
    --settings-sidebar-width: 12rem;
    --settings-window-radius: 0.75rem;  /* mobile sheet + macOS window top corners */
    /* Settings: macOS System Settings–style radius and spacing */
    --settings-radius: var(--home-radius-card);
    --settings-panel-gap: var(--home-space-md);
    --spacing-tool-layout-y: var(--home-space-sm);  /* 8px vertical padding for tool layout */
    /* Workbench (VS Code): editor vs panel surfaces; sidebar/activity bar; list focus for nav */
    --workbench-editor-bg: var(--code-bg);
    --workbench-panel-bg: var(--background);
    --activity-bar-background: var(--sidebar-background);
    --list-focus-background: var(--sidebar-accent);

    /* Settings page: VS Code–style surfaces (dark default) */
    --settings-nav-bg: 224 13% 14%;
    --settings-content-bg: var(--background);
    --settings-table-header-bg: 215 14% 22%;
    --settings-table-row-hover-bg: 215 14% 24%;
    /* Sidebar: VS Code–aligned widths and density */
    --sidebar-width-collapsed: 48px;   /* activity bar width */
    --sidebar-width-expanded: 272px;   /* primary sidebar (slightly wider than VS Code default) */
    --title-bar-height: 35px;           /* macOS-style title bar height */
    --title-bar-padding-x: var(--home-space-sm);   /* 8px horizontal (8px grid) */
    --title-bar-gap: var(--home-space-xs);         /* 4px between chrome buttons */
    --title-bar-font-size: var(--text-ui);   /* 13px – macOS/VS Code title */
    --title-bar-traffic-light-width: 72px; /* macOS: reserve for system controls */
    --title-bar-end-spacer: var(--home-space-xl); /* 32px right drag region */
    --panel-resizer-width: 0;        /* visual width/height: 0, only border line; hit area via padding */
    --panel-min-width: 120px;        /* min width per pane when side-by-side */
    --spacing-two-panel-gap: var(--home-space-sm); /* 8px gap between panes and resizer */
    --sidebar-item-min-height: 22px;   /* nav item height (VS Code) */
    --sidebar-search-height: 1.5rem;   /* 24px – compact, aligns with sidebar density */
    /* Sidebar spacing: 8px grid, aligned with --home-space-* (macOS-style) */
    --spacing-sidebar-x: var(--home-space-sm);
    --spacing-sidebar-y: var(--home-space-sm);
    --spacing-sidebar-gap: var(--home-space-xs);
    --spacing-sidebar-indent: var(--home-space-sm);
    --spacing-sidebar-item-y: var(--home-space-xs);
    --sidebar-radius: var(--home-radius-card);   /* macOS-style radius for search, links, donate */
    --radius-button: var(--home-radius-card);   /* macOS-style radius for buttons (toolbar, actions) */
    --spacing-sidebar-header-h: 1.75rem; /* 28px min height for panel header */
    --spacing-footer-min-h: 2.25rem;    /* 36px min height for sidebar footer */
    /* Liquid Glass (desktop): blur + visible edge; edge/highlight colors for sidebar/title-bar */
    --glass-blur: 44px;
    --glass-saturate: 200%;
    --glass-border-opacity: 0.14;
    --glass-highlight: 0.1;
    --glass-edge: 0 0% 100% / var(--glass-border-opacity);
    --glass-highlight-color: 0 0% 100% / var(--glass-highlight);
    /* Status (alerts, validation, badges) */
    --status-success: 142 69% 42%;
    --status-warning: 38 92% 50%;
    --status-error: 0 72% 51%;
    /* Motion: VS Code–style 150–200ms */
    --transition-duration: 0.15s;
    --transition-ease: ease;
    /* Desktop layout gradient (content area behind sidebar) */
    --desktop-layout-start: 224 13% 22%;
    --desktop-layout-end: 224 13% 12%;
  }

  .light {
    color-scheme: light;
    /* Warm neutrals (25°), WCAG AA on background; elevated surfaces pure white */
    --background: 25 20% 97%;
    --foreground: 25 25% 18%;

    --card: 0 0% 100%;
    --card-foreground: 25 25% 18%;

    --popover: var(--card);
    --popover-foreground: var(--card-foreground);

    --primary: 221 83% 53%;
    --primary-foreground: 0 0% 100%;

    --secondary: 25 15% 90%;
    --secondary-foreground: 25 25% 22%;

    --muted: 25 15% 92%;
    --muted-foreground: 25 15% 42%;

    --accent: var(--primary);
    --accent-foreground: var(--primary-foreground);

    --destructive: 0 72% 45%;
    --destructive-foreground: 0 0% 100%;

    --border: 25 12% 88%;
    --input: 25 12% 91%;
    --input-bg: 0 0% 100%;
    --segment-bg: 25 15% 92%;
    --segment-border: 25 12% 85%;
    --ring: 221 83% 53%;

    --radius: 0.625rem;

    --sidebar-background: 25 18% 94%;
    --sidebar-foreground: 25 25% 22%;
    --sidebar-primary: 221 83% 53%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 25 15% 90%;
    --sidebar-accent-foreground: 25 25% 18%;
    --sidebar-border: 25 12% 88%;
    --sidebar-ring: 221 83% 53%;
    --sidebar-active-border: var(--sidebar-primary);

    --code-bg: 0 0% 99%;
    --code-border: 25 10% 90%;
    --code-text: 25 25% 22%;
    --code-key: 25 35% 22%;
    --code-string: 142 45% 32%;
    --code-number: 25 75% 32%;
    --code-boolean: 258 55% 38%;
    --code-null: 258 55% 38%;
    --code-bracket: 25 15% 42%;
    --code-punctuation: 25 15% 42%;
    --code-comment: 25 10% 52%;
    --code-tag: 0 60% 42%;
    /* Random string view (light): darker shades for contrast on white */
    --code-rs-digit: 32 85% 42%;
    --code-rs-upper: 199 70% 36%;
    --code-rs-lower: 142 45% 32%;
    --code-rs-symbol: 25 15% 42%;
    --code-gutter-foreground: 25 10% 52%;

    --outline-button-bg: 0 0% 100%;
    --outline-button-border: 25 12% 85%;
    --outline-button-foreground: 25 25% 18%;

    --header-bg: 0 0% 98%;
    --header-tab-bg: 0 0% 100%;

    /* Settings page: light theme (subtle nav strip) */
    --settings-nav-bg: 25 15% 95%;
    --settings-content-bg: var(--background);
    --settings-table-header-bg: 25 12% 94%;
    --settings-table-row-hover-bg: 25 15% 92%;

    /* Liquid Glass – light: same blur, darker edge for contrast on light bg */
    --glass-blur: 44px;
    --glass-saturate: 200%;
    --glass-border-opacity: 0.14;
    --glass-highlight: 0.08;
    --glass-edge: 0 0% 0% / var(--glass-border-opacity);
    --glass-highlight-color: 0 0% 100% / 0.5;

    --status-success: 142 45% 32%;
    --status-warning: 38 92% 45%;
    --status-error: 0 72% 45%;
    --desktop-layout-start: 25 25% 98%;
    --desktop-layout-end: 25 20% 94%;
    --scrollbar-thumb: hsl(0 0% 0% / 0.2);
    --scrollbar-thumb-hover: hsl(0 0% 0% / 0.3);
    /* Typography: inherits --text-nav, --text-ui, --text-content, --text-caption, --text-hero from :root */
  }

  /* Deep dark: near-black (0°), OLED-friendly, WCAG AA muted text */
  .deep-dark {
    color-scheme: dark;
    --background: 0 0% 7%;
    --foreground: 0 0% 96%;

    --card: 0 0% 10%;
    --card-foreground: 0 0% 96%;

    --popover: var(--card);
    --popover-foreground: var(--card-foreground);

    --primary: 221 83% 53%;
    --primary-foreground: 0 0% 100%;

    --secondary: 0 0% 14%;
    --secondary-foreground: 0 0% 98%;

    --muted: 0 0% 14%;
    --muted-foreground: 0 0% 58%;

    --accent: var(--primary);
    --accent-foreground: var(--primary-foreground);

    --destructive: 0 72% 51%;
    --destructive-foreground: 0 0% 100%;

    --border: 0 0% 16%;
    --input: 0 0% 12%;
    --input-bg: 0 0% 9%;
    --segment-bg: 0 0% 14%;
    --segment-border: 0 0% 16%;
    --ring: 221 83% 53%;

    --radius: 0.625rem;

    --sidebar-background: 0 0% 9%;
    --sidebar-foreground: 0 0% 98%;
    --sidebar-primary: 221 83% 53%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 0 0% 16%;
    --sidebar-accent-foreground: 0 0% 98%;
    --sidebar-border: 0 0% 14%;
    --sidebar-ring: 221 83% 53%;
    --sidebar-active-border: var(--sidebar-primary);

    --header-bg: 0 0% 8%;
    --header-tab-bg: 0 0% 14%;

    /* Settings page: deep dark (OLED-friendly) */
    --settings-nav-bg: 0 0% 9%;
    --settings-content-bg: var(--background);
    --settings-table-header-bg: 0 0% 11%;
    --settings-table-row-hover-bg: 0 0% 12%;

    --code-bg: 0 0% 8%;
    --code-border: 0 0% 14%;
    --code-text: 0 0% 94%;
    --code-key: 0 0% 92%;
    --code-string: 142 69% 58%;
    --code-number: 31 92% 50%;
    --code-boolean: 258 90% 66%;
    --code-null: 258 90% 66%;
    --code-bracket: 0 0% 58%;
    --code-punctuation: 0 0% 58%;
    --code-comment: 0 0% 48%;
    --code-tag: 0 70% 65%;
    /* Random string view (deep dark): same semantics, OLED-safe */
    --code-rs-digit: 38 92% 55%;
    --code-rs-upper: 199 89% 48%;
    --code-rs-lower: 142 69% 58%;
    --code-rs-symbol: 0 0% 58%;
    --code-gutter-foreground: 0 0% 48%;

    --outline-button-bg: 0 0% 14%;
    --outline-button-border: 0 0% 22%;
    --outline-button-foreground: 0 0% 98%;

    --glass-blur: 44px;
    --glass-saturate: 200%;
    --glass-border-opacity: 0.12;
    --glass-highlight: 0.08;
    --glass-edge: 0 0% 100% / var(--glass-border-opacity);
    --glass-highlight-color: 0 0% 100% / var(--glass-highlight);

    --status-success: 142 69% 42%;
    --status-warning: 38 92% 50%;
    --status-error: 0 72% 51%;
    --desktop-layout-start: 0 0% 10%;
    --desktop-layout-end: 0 0% 5%;
  }

  * {
    @apply border-border;
  }

  /* VS Code–style text selection (primary tint, foreground for contrast) */
  ::selection {
    background: hsl(var(--primary) / 0.3);
    color: hsl(var(--foreground));
  }

  /* Global focus-visible: ring from --focus-ring (sidebar uses --focus-ring-sidebar) */
  :focus-visible {
    outline: none;
    box-shadow: var(--focus-ring);
  }
  .sidebar-link:focus-visible,
  .sidebar-donate-link:focus-visible {
    box-shadow: var(--focus-ring-sidebar);
  }
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible {
    outline: none;
    box-shadow: none;
  }

  body {
    @apply bg-background text-foreground;
    font-family: var(--font-sans);
    transition: background-color var(--transition-duration-slow) var(--transition-ease), color var(--transition-duration-slow) var(--transition-ease);
  }

  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Web: root fills viewport so flex layout (App) is full height, no body scroll */
  #root {
    height: 100vh;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* Desktop app window: fill viewport, no body scroll; only inner content scrolls */
  html.desktop,
  html.desktop body {
    height: 100%;
    overflow: hidden;
    margin: 0;
  }
  html.desktop #root {
    height: 100%;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* Content area behind sidebar: gradient per theme (--desktop-layout-start/end) */
  html.desktop .desktop-layout {
    background: radial-gradient(ellipse 100% 120% at 80% 30%, hsl(var(--desktop-layout-start)), hsl(var(--desktop-layout-end)));
  }

  /* Title bar: Liquid Glass – token-based (--glass-edge, --glass-highlight-color per theme) */
  .desktop-title-bar {
    background: hsl(var(--header-bg) / 0.48);
    backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
    -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
    border-bottom: 1px solid hsl(var(--glass-edge));
    box-shadow: inset 0 1px 0 0 hsl(var(--glass-highlight-color));
    padding-left: var(--title-bar-padding-x);
    padding-right: var(--title-bar-padding-x);
    gap: var(--title-bar-gap);
  }
  .desktop-title-bar .title-bar-title {
    font-size: var(--title-bar-font-size);
    font-weight: 500;
    color: hsl(var(--foreground) / 0.9);
  }
  .desktop-title-bar .title-tab {
    background: hsl(var(--header-tab-bg));
    border: 1px solid hsl(var(--border));
    border-bottom: none;
    border-radius: var(--home-radius-card) var(--home-radius-card) 0 0;
    padding: 0 var(--home-space-md);
    min-height: var(--home-space-lg);
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }
  .desktop-title-bar .desktop-title-plain {
    padding: 0 var(--home-space-sm);
  }
  .desktop-title-bar .title-bar-traffic-light-spacer {
    width: var(--title-bar-traffic-light-width);
  }
  .desktop-title-bar .title-bar-end-spacer {
    width: var(--title-bar-end-spacer);
  }

  /* Thin scrollbars in desktop window (--scrollbar-thumb / --scrollbar-thumb-hover per theme) */
  html.desktop {
    scrollbar-width: thin;
    scrollbar-color: var(--scrollbar-thumb) transparent;
  }
  html.desktop ::-webkit-scrollbar {
    width: var(--home-space-sm);
    height: var(--home-space-sm);
  }
  html.desktop ::-webkit-scrollbar-track {
    background: transparent;
  }
  html.desktop ::-webkit-scrollbar-thumb {
    background: var(--scrollbar-thumb);
    border-radius: var(--radius-sm);
  }
  html.desktop ::-webkit-scrollbar-thumb:hover {
    background: var(--scrollbar-thumb-hover);
  }

  code, pre, .font-mono {
    font-family: var(--font-mono) !important;
  }

  /* Responsive: tighter panel padding when stacked (12px then 8px/6px) */
  @media (max-width: 1023px) {
    :root {
      --spacing-panel-inner-x: var(--home-space-inner);
      --spacing-panel-inner-y: var(--home-space-sm);
    }
  }
  @media (max-width: 639px) {
    :root {
      --spacing-panel-inner-x: var(--home-space-sm);
      --spacing-panel-inner-y: var(--home-space-stack);
    }
  }
}

@layer components {
  .code-block {
    @apply rounded-xl border font-mono leading-relaxed overflow-auto transition-colors duration-150;
    padding: var(--spacing-code-editor);
    font-size: var(--text-content);
    background: hsl(var(--code-bg));
    border-color: hsl(var(--code-border));
    color: hsl(var(--code-text));
  }

  /* Result/summary block: VS Code–style (no fill), consistent padding with panel/system tokens */
  .tool-card {
    @apply rounded-xl border transition-colors duration-150;
    padding: var(--spacing-panel-inner-y) var(--spacing-panel-inner-x);
    background: transparent;
    border-color: hsl(var(--border));
  }

  .tool-textarea {
    @apply w-full rounded-xl border font-mono leading-relaxed resize-y transition-colors duration-150;
    padding: var(--spacing-code-editor);
    font-size: var(--text-content);
    background: hsl(var(--code-bg));
    border-color: hsl(var(--code-border));
    color: hsl(var(--foreground));
    min-height: 280px;
    max-height: 85vh;
  }

  /* Tool layout: full width/height wrapper. Padded variant uses dense tokens (8px base). */
  .tool-layout-inner {
    width: 100%;
    height: 100%;
    min-height: 0;
  }
  .tool-layout-inner--padded {
    padding: var(--spacing-tool-layout-y) var(--spacing-tool-layout-x);
  }
  .tool-layout-title {
    margin-bottom: var(--spacing-tool-layout-y);
    gap: var(--spacing-block-gap);
  }
  .tool-layout-title h1 {
    font-size: var(--text-content);
    font-weight: 600;
    letter-spacing: -0.01em;
    color: hsl(var(--foreground));
  }
  .tool-layout-title .tool-layout-description {
    font-size: var(--text-ui);
    color: hsl(var(--muted-foreground));
  }
  .tool-layout-section {
    margin-bottom: var(--spacing-section-mb);
  }

  /* Validator/tool form: label above input (8px grid) */
  .tool-field-label {
    font-size: var(--text-nav);
    color: hsl(var(--muted-foreground));
    margin-bottom: var(--spacing-block-gap);
    display: block;
  }

  /* Section heading inside tool-card (e.g. "Validate (Luhn)", "Match Details") */
  .tool-section-heading {
    font-size: var(--text-content);
    font-weight: 500;
    color: hsl(var(--foreground));
    margin-bottom: var(--spacing-block-gap);
  }

  /* Inline alert for error/success (design tokens) */
  .tool-alert {
    padding: var(--spacing-panel-inner-y) var(--spacing-panel-inner-x);
    font-size: var(--text-ui);
    border-radius: var(--radius);
    border: 1px solid;
    transition: background var(--transition-default), border-color var(--transition-default);
  }
  .tool-alert--error {
    color: hsl(var(--destructive));
    border-color: hsl(var(--destructive) / 0.5);
    background: hsl(var(--destructive) / 0.08);
  }
  .tool-alert--success {
    color: hsl(var(--status-success));
    border-color: hsl(var(--status-success) / 0.5);
    background: hsl(var(--status-success) / 0.08);
  }

  /* Success text (e.g. "✓ Valid") – semantic status */
  .text-status-success {
    color: hsl(var(--status-success));
  }

  /* Code editor: VS Code–style panel (workbench editor surface) */
  .code-editor-wrapper {
    background: hsl(var(--workbench-editor-bg));
    border: 1px solid hsl(var(--code-border));
    border-radius: var(--radius);
    font-family: var(--font-mono);
    font-size: var(--code-font-size);
    line-height: var(--code-line-height);
  }
  .code-editor-wrapper .code-editor-pad {
    padding: var(--spacing-code-editor);
  }

  /* Use with grid/flex for consistent gap from --spacing-grid-gap */
  .tool-content-grid {
    gap: var(--spacing-grid-gap);
  }
  .tool-content-grid--dense {
    gap: var(--spacing-panel-resizer-gap);
  }
  .tool-content-stack {
    gap: var(--spacing-grid-gap);
  }

  /* Shared table pattern: cells, border, thead th (tool + settings); then context-specific thead bg / row hover */
  .tool-reference-table,
  .settings-table {
    width: 100%;
    font-size: var(--text-nav);
  }
  .tool-reference-table th, .tool-reference-table td,
  .settings-table th, .settings-table td {
    padding: var(--home-space-sm) var(--home-space-md);
    text-align: left;
    border-bottom: 1px solid hsl(var(--border));
  }
  .tool-reference-table thead th,
  .settings-table thead th {
    color: hsl(var(--muted-foreground));
    font-weight: 500;
  }
  .tool-reference-table tbody tr:last-child td,
  .settings-table tbody tr:last-child td {
    border-bottom: none;
  }
  .tool-reference-table-wrap {
    border: 1px solid hsl(var(--border));
    border-radius: var(--home-radius-card);
    overflow: hidden;
  }
  .tool-reference-table th, .tool-reference-table td { font-size: var(--text-caption); }
  .tool-reference-table thead tr { background: hsl(var(--muted) / 0.5); }
  .tool-reference-table tbody tr:hover { background: hsl(var(--muted) / 0.3); }

  .tool-layout-content > .tool-toolbar {
    flex-shrink: 0;
    margin-bottom: var(--spacing-toolbar-mb);
  }

  .tool-layout-content > .grid {
    flex: 1;
    min-height: 0;
    min-width: 0;
    grid-auto-rows: minmax(0, 1fr);
  }

  /* Stacked grid (1 column): min-height per panel so each stays usable (VS Code–style responsive). */
  @media (max-width: 1023px) {
    .tool-layout-content > .grid.tool-content-grid .tool-panel {
      min-height: min(12rem, 40vh);
    }
  }
  @media (max-width: 1023px) and (max-height: 480px) {
    .tool-layout-content > .grid.tool-content-grid .tool-panel {
      min-height: min(10rem, 35vh);
    }
  }

  .tool-layout-content > .tool-panel {
    flex: 1;
    min-height: 0;
  }

  /* Panel header label: VS Code–style small, uppercase, letter-spacing */
  .panel-header-label {
    font-size: var(--text-nav);
    font-weight: 600;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    color: hsl(var(--foreground));
  }

  /* Pane: header + body; gap = only vertical space between them (no double padding). */
  .tool-panel {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-panel-gap);
    width: 100%;
    min-height: 0;
    flex: 1;
    overflow: hidden;
    margin: 0;
    padding: 0;
  }

  /* Resize panels separator: width/height 0, only border line visible; hit area via padding. */
  .panel-resizer {
    margin: 0;
    padding: 0 var(--home-space-sm);
    width: var(--panel-resizer-width);
    min-width: var(--panel-resizer-width);
    background: transparent;
    transition: background var(--transition-default);
  }
  .panel-resizer:hover {
    background: hsl(var(--muted) / 0.35);
  }
  .panel-resizer-line {
    margin: 0;
    padding: 0;
    background: hsl(var(--border));
    transition: background var(--transition-default);
  }
  .panel-resizer:hover .panel-resizer-line {
    background: hsl(var(--muted-foreground) / 0.5);
  }
  .panel-resizer:focus-visible {
    outline: none;
    background: hsl(var(--muted) / 0.4);
    box-shadow: var(--focus-ring);
  }
  .panel-resizer:focus-visible .panel-resizer-line {
    background: hsl(var(--primary) / 0.8);
  }
  /* Horizontal resizer (stacked/small screen): full width, height 0, hit area via padding */
  .panel-resizer--horizontal {
    width: 100%;
    min-width: 0;
    padding: var(--home-space-sm) 0;
    height: var(--panel-resizer-width);
    min-height: var(--panel-resizer-width);
  }

  /* Two-panel top section (alerts, validation, options): panel-style border + bg (VS Code message area) */
  .tool-layout-top-section {
    padding: var(--spacing-panel-inner-y) var(--spacing-panel-inner-x);
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
    gap: var(--spacing-block-gap);
    min-height: 0;
    overflow: auto;
    max-height: min(40vh, 20rem);
  }
  .tool-layout-format-error {
    padding: var(--spacing-panel-inner-y) var(--spacing-panel-inner-x);
    color: hsl(var(--destructive));
    font-size: var(--text-ui);
    transition: background var(--transition-default), border-color var(--transition-default);
  }

  /* Settings page: tabs, option cards, section headings (design system tokens) */
  .settings-tabs {
    display: flex;
    gap: var(--spacing-block-gap);
    margin-bottom: var(--spacing-section-mb);
    border-bottom: 1px solid hsl(var(--border));
  }
  .settings-tab {
    display: flex;
    align-items: center;
    gap: var(--spacing-block-gap);
    padding: var(--home-space-sm) var(--home-space-md);
    font-size: var(--text-ui);
    font-weight: 500;
    color: hsl(var(--muted-foreground));
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    cursor: pointer;
    transition: color var(--transition-default), border-color var(--transition-default);
  }
  .settings-tab:hover {
    color: hsl(var(--foreground));
  }
  .settings-tab:focus-visible {
    outline: none;
    border-radius: var(--radius) var(--radius) 0 0;
    box-shadow: var(--focus-ring);
  }
  .settings-tab--selected {
    color: hsl(var(--primary));
    border-bottom-color: hsl(var(--primary));
  }
  .settings-option-card {
    border-radius: var(--radius-sm);
    border: 1px solid hsl(var(--border));
    padding: var(--home-space-xs) var(--home-space-sm);
    text-align: left;
    cursor: pointer;
    background: hsl(var(--background));
    color: hsl(var(--foreground));
    transition: border-color var(--transition-default), background var(--transition-default);
  }
  .settings-option-card .settings-label {
    font-size: var(--text-caption);
  }
  .settings-option-card .settings-body-text {
    font-size: var(--text-caption); /* compact: 11px via token */
    margin-top: var(--home-space-xs);
  }
  .settings-option-card:hover {
    background: hsl(var(--muted) / 0.5);
    border-color: hsl(var(--border));
  }
  .settings-option-card:focus-visible {
    outline: none;
    border-radius: var(--radius-sm);
    box-shadow: var(--focus-ring);
  }
  .settings-option-card--selected {
    border-color: hsl(var(--primary));
    background: hsl(var(--primary) / 0.12);
    box-shadow: 0 0 0 1px hsl(var(--primary));
  }
  .settings-section-heading {
    display: flex;
    align-items: center;
    gap: var(--home-space-sm);
    font-size: var(--text-caption);
    font-weight: 600;
    letter-spacing: 0.02em;
    text-transform: uppercase;
    color: hsl(var(--muted-foreground));
    margin-bottom: var(--home-space-xs);
  }
  .settings-section-heading svg {
    width: var(--text-nav);
    height: var(--text-nav);
    opacity: 0.9;
  }
  .settings-option-grid {
    display: grid;
    gap: var(--home-space-xs);
  }
  .settings-panel {
    display: flex;
    flex-direction: column;
    gap: var(--settings-panel-gap);
    width: 100%;
  }
  .settings-section {
    margin-bottom: var(--home-space-sm);
  }
  .settings-section:last-child {
    margin-bottom: 0;
  }
  .settings-section-content {
    padding-left: 0;
  }
  .settings-tools-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--home-space-sm);
  }
  .settings-tools-count {
    margin: var(--home-space-sm) 0 var(--home-space-sm);
  }
  .settings-table-wrap {
    border: 1px solid hsl(var(--border));
    border-radius: var(--settings-radius);
    overflow: auto;
    max-height: min(22rem, 55vh);
  }
  .settings-table th, .settings-table td { font-size: var(--text-nav); }
  .settings-table--compact th, .settings-table--compact td {
    padding: var(--home-space-sm) var(--home-space-md);
    font-size: var(--text-nav);
    vertical-align: middle;
  }
  .settings-table--compact thead th { font-weight: 500; }
  .settings-table thead tr { background: hsl(var(--settings-table-header-bg)); }
  .settings-table-wrap .settings-table thead th {
    position: sticky;
    top: 0;
    z-index: 1;
    background: hsl(var(--settings-table-header-bg));
    box-shadow: 0 1px 0 hsl(var(--border));
  }
  .settings-table tbody tr:hover { background: hsl(var(--settings-table-row-hover-bg)); }
  .settings-body-text {
    font-size: var(--text-content);
    color: hsl(var(--muted-foreground));
    line-height: 1.5;
  }
  .settings-label {
    font-size: var(--text-content);
    font-weight: 500;
    color: hsl(var(--foreground));
  }
  .settings-setting-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--home-space-md);
    min-height: 2.5rem;
  }
  .settings-setting-label {
    flex: 0 1 auto;
    text-align: left;
    font-size: var(--text-ui);
    font-weight: 500;
    color: hsl(var(--foreground));
  }
  .settings-setting-control {
    flex: 0 0 auto;
    min-width: 0;
  }

  /* Settings page: dialog modal (industry-standard width, readable density) */
  .settings-modal-container {
    position: fixed;
    inset: 0;
    z-index: 50;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--home-space-md);
    padding-left: max(var(--home-space-md), env(safe-area-inset-left));
    padding-right: max(var(--home-space-md), env(safe-area-inset-right));
    padding-bottom: max(var(--home-space-md), env(safe-area-inset-bottom));
    padding-top: max(var(--home-space-md), env(safe-area-inset-top));
    pointer-events: none;
  }
  .settings-modal-container > * {
    pointer-events: auto;
  }
  .settings-backdrop {
    position: absolute;
    inset: 0;
    background: hsl(0 0% 0% / 0.5);
    cursor: pointer;
  }
  .settings-dialog {
    position: relative;
    z-index: 1;
    width: 100%;
    max-width: var(--home-content-max-width);
    height: min(85vh, 38rem);
    min-height: min(72vh, 28rem);
    max-height: calc(100dvh - 2rem);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border-radius: var(--settings-radius);
    box-shadow: 0 20px 40px -12px hsl(0 0% 0% / 0.35);
    background: hsl(var(--background));
    border: 1px solid hsl(var(--border));
  }
  html.desktop .settings-dialog {
    border-radius: var(--settings-window-radius);
    box-shadow: 0 25px 50px -12px hsl(0 0% 0% / 0.25), 0 0 0 1px hsl(var(--border) / 0.5);
    background: hsl(var(--background) / 0.92);
    backdrop-filter: blur(32px) saturate(150%);
    -webkit-backdrop-filter: blur(32px) saturate(150%);
    border-color: hsl(var(--border) / 0.6);
  }
  .settings-dialog-close {
    color: hsl(var(--muted-foreground));
    flex-shrink: 0;
  }
  .settings-dialog-close:hover {
    color: hsl(var(--foreground));
  }
  /* Mobile-only top bar: Settings title + Close (macOS/iOS-style title bar) */
  .settings-mobile-header {
    display: none;
    flex-shrink: 0;
    align-items: center;
    justify-content: space-between;
    gap: var(--home-space-md);
    min-height: var(--min-touch);
    padding: var(--home-space-sm) var(--home-space-md);
    padding-top: max(var(--home-space-md), env(safe-area-inset-top));
    padding-left: max(var(--home-space-md), env(safe-area-inset-left));
    padding-right: max(var(--home-space-md), env(safe-area-inset-right));
    border-bottom: 1px solid hsl(var(--border));
    background: hsl(var(--background));
  }
  .settings-mobile-header-title {
    font-size: var(--text-hero);
    font-weight: 600;
    color: hsl(var(--foreground));
    letter-spacing: -0.01em;
    line-height: 1.25;
  }
  .settings-mobile-close {
    min-width: var(--min-touch);
    min-height: var(--min-touch);
    flex-shrink: 0;
    margin: calc(-1 * var(--home-space-sm));
    margin-right: calc(-1 * var(--home-space-sm));
  }
  .settings-layout {
    display: flex;
    flex: 1 1 auto;
    min-height: 0;
    overflow: hidden;
  }
  /* Sidebar: macOS System Settings–style list (vibrancy, pill selection) */
  .settings-sidebar {
    flex-shrink: 0;
    width: var(--settings-sidebar-width);
    padding: var(--home-space-md) var(--home-space-sm) var(--home-space-lg);
    overflow-y: auto;
    background: hsl(var(--muted) / 0.4);
    border-right: 1px solid hsl(var(--border));
  }
  html.desktop .settings-sidebar {
    background: hsl(var(--muted) / 0.3);
    backdrop-filter: blur(var(--glass-blur-sidebar)) saturate(var(--glass-saturate-sidebar));
    -webkit-backdrop-filter: blur(var(--glass-blur-sidebar)) saturate(var(--glass-saturate-sidebar));
    border-right-color: hsl(var(--border) / 0.6);
  }
  .settings-sidebar-title {
    margin: 0 0 var(--home-space-md);
    padding: 0 var(--home-space-md);
    font-size: var(--text-ui);
    font-weight: 600;
    color: hsl(var(--muted-foreground));
    letter-spacing: 0.02em;
  }
  .settings-category-list {
    display: flex;
    flex-direction: column;
    gap: var(--home-space-2xs);
    padding: 0;
    list-style: none;
  }
  .settings-category-item {
    display: flex;
    align-items: center;
    gap: var(--home-space-sm);
    width: 100%;
    padding: var(--home-space-sm) var(--home-space-md);
    font-size: var(--text-ui);
    font-weight: 500;
    color: hsl(var(--muted-foreground));
    background: transparent;
    border: none;
    border-radius: var(--radius-item);
    cursor: pointer;
    text-align: left;
    transition: color var(--transition-default), background var(--transition-default);
  }
  .settings-category-item:hover {
    color: hsl(var(--foreground));
    background: hsl(var(--muted) / 0.5);
  }
  .settings-category-item:focus-visible {
    outline: none;
    box-shadow: var(--focus-ring);
  }
  .settings-category-item--selected {
    font-weight: 600;
    color: hsl(var(--primary-foreground));
    background: hsl(var(--primary));
    border-radius: var(--radius-item);
  }
  html.desktop .settings-category-item--selected {
    border-radius: 9999px;
  }
  .settings-category-item--selected:hover {
    background: hsl(var(--primary) / 0.9);
    color: hsl(var(--primary-foreground));
  }
  .settings-category-icon-wrap {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  .settings-category-icon {
    width: var(--text-content);
    height: var(--text-content);
    flex-shrink: 0;
    opacity: 0.9;
  }
  .settings-category-item--selected .settings-category-icon {
    opacity: 1;
  }
  .settings-category-label {
    min-width: 0;
  }
  .settings-content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: transparent;
    color: hsl(var(--foreground));
  }
  .settings-content-header {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--home-space-sm);
    padding: var(--home-space-sm) var(--home-space-xl) var(--home-space-sm) var(--home-space-xl);
    border-bottom: 1px solid hsl(var(--border) / 0.7);
  }
  .settings-panel-title {
    margin: 0;
    font-size: var(--text-title);
    font-weight: 600;
    color: hsl(var(--foreground));
    letter-spacing: -0.01em;
  }
  .settings-content-body {
    flex: 1;
    min-height: 0;
    overflow-y: auto;
    padding: var(--home-space-xl) var(--home-space-xl) var(--home-space-2xl);
  }
  .settings-section {
    margin-bottom: 0;
    padding-top: var(--home-space-lg);
    border-top: 1px solid hsl(var(--border) / 0.6);
  }
  .settings-section:first-child {
    padding-top: 0;
    border-top: none;
  }
  .settings-section-content {
    padding-left: 0;
    display: flex;
    flex-direction: column;
    gap: var(--home-space-sm);
  }
  /* Checkbox in settings: visible border and background so it doesn’t blend with panel */
  /* Preferences components (generic, macOS-style): section, group, row, label, control, description */
  .pref-section {
    padding-top: var(--home-space-xl);
    border-top: 1px solid hsl(var(--border) / 0.6);
  }
  .pref-section:first-child {
    padding-top: 0;
    border-top: none;
  }
  .pref-section__heading {
    margin: 0 0 var(--home-space-sm);
    font-size: var(--text-caption);
    font-weight: 600;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: hsl(var(--muted-foreground));
  }
  .pref-section__content {
    display: flex;
    flex-direction: column;
    gap: 0;
  }
  .pref-group {
    border-radius: var(--radius);
    background: hsl(var(--muted) / 0.25);
    border: 1px solid hsl(var(--border) / 0.5);
    overflow: hidden;
  }
  .pref-group .pref-row {
    border-bottom: 1px solid hsl(var(--border) / 0.4);
  }
  .pref-group .pref-row:last-child {
    border-bottom: none;
  }
  .pref-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--home-space-md);
    min-height: 2.75rem;
    padding: 0 var(--home-space-lg);
  }
  .pref-group .pref-row {
    padding: 0 var(--home-space-lg);
    min-height: 2.75rem;
  }
  .pref-label {
    flex: 0 1 auto;
    font-size: var(--text-content);
    font-weight: 500;
    color: hsl(var(--foreground));
  }
  .pref-control {
    flex: 0 0 auto;
    min-width: 0;
  }
  .pref-description {
    margin: var(--home-space-xs) 0 0;
    font-size: var(--text-caption);
    line-height: 1.4;
    color: hsl(var(--muted-foreground));
  }
  .pref-section__content > .pref-description {
    margin-top: var(--home-space-xs);
    margin-bottom: var(--home-space-xs);
  }
  .pref-body {
    font-size: var(--text-content);
    color: hsl(var(--muted-foreground));
    line-height: 1.5;
    margin: var(--home-space-xs) 0 0;
  }
  .pref-control .pref-body {
    margin: 0;
  }
  @media (max-width: 480px) {
    .pref-row {
      flex-direction: column;
      align-items: flex-start;
      gap: var(--home-space-sm);
      padding-top: var(--home-space-md);
      padding-bottom: var(--home-space-md);
      min-height: var(--min-touch);
    }
    .pref-group .pref-row {
      padding-left: var(--home-space-md);
      padding-right: var(--home-space-md);
      min-height: var(--min-touch);
    }
    .pref-control {
      width: 100%;
    }
  }

  .settings-panel [role="checkbox"] {
    border-color: hsl(var(--border));
    background-color: hsl(var(--muted) / 0.5);
  }
  .settings-panel [role="checkbox"][data-state="checked"] {
    border-color: hsl(var(--primary));
    background-color: hsl(var(--primary));
    color: hsl(var(--primary-foreground));
  }
  .settings-section-heading {
    font-size: var(--text-nav);
    margin-bottom: var(--home-space-sm);
  }
  .settings-section-heading svg {
    width: var(--text-content);
    height: var(--text-content);
  }
  /* Tablet: slightly tighter so dialog doesn’t feel cramped */
  @media (max-width: 768px) {
    .settings-dialog {
      max-width: min(100%, 36rem);
      height: min(90dvh, 36rem);
      min-height: min(70dvh, 24rem);
    }
    .settings-content-body {
      padding: var(--home-space-md) var(--home-space-lg) var(--home-space-md);
    }
  }

  /* Mobile: full-bleed sheet (macOS/iOS-style), safe areas, 8px grid, 44px touch targets */
  @media (max-width: 640px) {
    .settings-modal-container {
      padding: 0;
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      padding-bottom: env(safe-area-inset-bottom);
      padding-top: env(safe-area-inset-top);
      align-items: stretch;
    }
    .settings-dialog {
      max-width: none;
      width: 100%;
      height: 100%;
      min-height: 0;
      max-height: none;
      border-radius: var(--settings-window-radius) var(--settings-window-radius) 0 0;
      border-left: none;
      border-right: none;
      box-shadow: 0 -4px 24px hsl(0 0% 0% / 0.2);
    }
    .settings-mobile-header {
      display: flex;
    }
    .settings-content-header {
      display: none;
    }
    .settings-layout {
      flex-direction: column;
      min-height: 0;
      flex: 1;
      overflow: hidden;
    }
    .settings-sidebar {
      width: 100%;
      flex-shrink: 0;
      padding: var(--home-space-sm) var(--home-space-md);
      padding-left: max(var(--home-space-md), env(safe-area-inset-left));
      padding-right: max(var(--home-space-md), env(safe-area-inset-right));
      border-right: none;
      border-bottom: 1px solid hsl(var(--border));
      background: hsl(var(--muted) / 0.25);
    }
    .settings-sidebar-title {
      display: none;
    }
    /* Segmented control: equal-width tabs, no horizontal scroll (industry practice) */
    .settings-category-list {
      flex-direction: row;
      flex-wrap: nowrap;
      gap: var(--home-space-xs);
      overflow: hidden;
      padding: 0;
    }
    /* Each tab shares width so all fit on one row */
    .settings-category-item {
      flex: 1 1 0;
      min-width: 0;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: var(--home-space-xs);
      min-height: var(--min-touch);
      padding: var(--home-space-xs) var(--home-space-sm);
      font-size: var(--text-content);
      border-radius: var(--home-radius-card);
    }
    .settings-category-item .settings-category-icon-wrap {
      width: auto;
      height: auto;
      background: transparent;
      border-radius: 0;
    }
    .settings-category-item .settings-category-icon {
      width: var(--text-content);
      height: var(--text-content);
    }
    .settings-category-item .settings-category-label {
      font-size: var(--text-caption);
      font-weight: 500;
      text-align: center;
      line-height: 1.2;
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .settings-content-body {
      flex: 1;
      min-height: 0;
      overflow-y: auto;
      padding: var(--home-space-lg) var(--home-space-md);
      padding-left: max(var(--home-space-md), env(safe-area-inset-left));
      padding-right: max(var(--home-space-md), env(safe-area-inset-right));
      padding-bottom: max(var(--home-space-2xl), env(safe-area-inset-bottom));
      -webkit-overflow-scrolling: touch;
    }
    .settings-section {
      padding-top: var(--home-space-lg);
      margin-bottom: 0;
    }
    .settings-section:first-child {
      padding-top: 0;
    }
    .settings-option-grid {
      gap: var(--home-space-sm);
    }
    .settings-table th,
    .settings-table td {
      padding: var(--home-space-sm) var(--home-space-md);
      min-height: var(--min-touch);
      box-sizing: border-box;
    }
  }

  /* Narrow content: stack setting rows (label above control) for readability */
  @media (max-width: 480px) {
    .settings-setting-row {
      flex-direction: column;
      align-items: flex-start;
      gap: var(--home-space-sm);
    }
    .settings-setting-control {
      width: 100%;
    }
  }

  /* Stacked two-panel: minimum height per pane so both remain usable (responsive). */
  .two-panel-stacked .tool-panel {
    min-height: min(12rem, 40vh);
  }
  @media (max-height: 480px) {
    .two-panel-stacked .tool-panel {
      min-height: min(10rem, 35vh);
    }
  }

  .tool-panel .tool-textarea,
  .tool-panel .code-block,
  .tool-panel .code-editor-wrapper {
    @apply flex-1;
    min-height: 0;
  }

  .tool-panel .code-editor-wrapper textarea {
    height: 100% !important;
    min-height: 100% !important;
  }

  .tool-panel .code-block {
    @apply overflow-auto;
  }

  /* Toolbar: top, fit height (VS Code/Linear: 8px gap) */
  .tool-toolbar {
    @apply flex items-center gap-2 flex-wrap flex-shrink-0;
    margin-bottom: var(--spacing-toolbar-mb);
  }

  /* Unified control surface: shared by .control-base, .tool-select, .input-compact (reusable token set) */
  .control-base,
  .tool-select,
  .input-compact {
    background: hsl(var(--background));
    color: hsl(var(--foreground));
    border: 1px solid hsl(var(--input));
    font-size: var(--text-content);
  }

  .tool-select {
    @apply h-9 rounded-lg px-3 py-2 font-medium transition-colors duration-150 cursor-pointer;
  }

  .tool-select:hover {
    background: hsl(var(--accent));
    color: hsl(var(--accent-foreground));
  }

  .input-compact {
    @apply h-9 rounded-lg px-3 py-2 font-mono placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-150;
  }

  .tool-checkbox-label {
    @apply flex items-center gap-2 text-sm font-medium text-muted-foreground cursor-pointer select-none transition-colors;
  }

  .tool-checkbox-label:hover {
    color: hsl(var(--foreground));
  }

  .tool-checkbox-label input[type="checkbox"] {
    @apply rounded;
    accent-color: hsl(var(--primary));
  }

  .sidebar-pad {
    padding: var(--spacing-sidebar-y) var(--spacing-sidebar-x);
  }

  .sidebar-footer-pad {
    padding-top: var(--spacing-sidebar-gap);
    padding-bottom: var(--spacing-sidebar-gap);
    padding-left: var(--spacing-sidebar-x);
    padding-right: var(--spacing-sidebar-x);
    min-height: var(--spacing-footer-min-h);
  }

  /* Sidebar nav items: macOS-style radius, 8px grid, typography from design tokens */
  .sidebar-link {
    @apply flex items-center transition-colors duration-150 min-w-0;
    gap: var(--home-space-sm);
    min-height: var(--sidebar-item-min-height);
    padding: var(--spacing-sidebar-item-y) var(--spacing-sidebar-x);
    border-radius: var(--sidebar-radius);
    font-size: var(--text-nav);
    font-weight: 500;
    color: hsl(var(--sidebar-foreground));
  }

  .sidebar-link:hover {
    background: hsl(var(--sidebar-accent));
    color: hsl(var(--sidebar-accent-foreground));
  }

  .sidebar-link.active {
    background: hsl(var(--sidebar-accent));
    color: hsl(var(--sidebar-foreground));
  }

  .sidebar-link.active:hover {
    background: hsl(var(--sidebar-accent));
    color: hsl(var(--sidebar-foreground));
  }
  .sidebar-link--icon-only {
    justify-content: center;
    padding-left: var(--home-space-sm);
    padding-right: var(--home-space-sm);
  }
  .sidebar-collapsed .sidebar-link--icon-only {
    padding-left: var(--home-space-sm);
    padding-right: var(--home-space-sm);
  }
  .sidebar-group-trigger {
    cursor: pointer;
  }
  .sidebar-donate-link--icon-only {
    justify-content: center;
    padding: var(--home-space-sm);
  }

  /* Activity bar (collapsed): VS Code–style left accent on active item */
  .sidebar-activity-item {
    border-left: 3px solid transparent;
  }
  .sidebar-activity-item.active {
    border-left-color: hsl(var(--sidebar-active-border));
  }

  /* Sidebar section headers (group labels): macOS-style caption, uppercase, muted */
  .sidebar-group-label {
    font-size: var(--text-nav);
    font-weight: 600;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    color: hsl(var(--muted-foreground));
  }
  .sidebar-link:hover .sidebar-group-label,
  .sidebar-link.active .sidebar-group-label {
    color: inherit;
  }

  /* Sidebar search: macOS-style radius, 8px grid, glass-like input */
  .sidebar-search {
    height: var(--sidebar-search-height);
    padding: 0 var(--home-space-sm) 0 1.75rem;
    font-size: var(--text-nav);
    border-radius: var(--sidebar-radius);
    border: 1px solid hsl(var(--sidebar-border));
    background: hsl(var(--sidebar-accent) / 0.5);
    color: hsl(var(--sidebar-foreground));
    transition: border-color var(--transition-default), box-shadow var(--transition-default);
  }
  .sidebar-search::placeholder {
    color: hsl(var(--muted-foreground));
  }
  .sidebar-search:focus {
    outline: none;
    border-color: hsl(var(--sidebar-ring));
    box-shadow: 0 0 0 1px hsl(var(--sidebar-ring));
  }

  /* Sidebar search results label and empty state: macOS-style typography */
  .sidebar-results-label {
    font-size: var(--text-nav);
    font-weight: 500;
    letter-spacing: 0.02em;
    color: hsl(var(--muted-foreground));
    padding: 0 var(--spacing-sidebar-x) var(--home-space-xs);
  }
  .sidebar-empty {
    font-size: var(--text-nav);
    color: hsl(var(--muted-foreground));
    text-align: center;
    padding: var(--home-space-lg) var(--spacing-sidebar-x);
  }

  /* Chrome icon buttons (sidebar + title bar): macOS-style radius, 8px grid */
  .btn-icon-chrome {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    border-radius: var(--radius-button);
    color: hsl(var(--muted-foreground));
    transition: color var(--transition-default), background-color var(--transition-default), opacity var(--transition-default);
  }
  .btn-icon-chrome:hover {
    color: hsl(var(--foreground));
    background: hsl(var(--sidebar-accent));
  }
  .btn-icon-chrome:active {
    opacity: 0.85;
  }
  .btn-icon-chrome-sm {
    width: 1.75rem;
    height: 1.75rem;
  }

  /* Sidebar donate CTA: macOS-style radius, 8px grid, compact */
  .sidebar-donate-link {
    display: inline-flex;
    align-items: center;
    gap: var(--home-space-xs);
    min-width: 0;
    padding: var(--home-space-xs) var(--home-space-sm);
    font-size: var(--text-nav);
    font-weight: 500;
    border-radius: var(--sidebar-radius);
    border: 1px solid hsl(var(--sidebar-border));
    background: hsl(var(--sidebar-accent) / 0.6);
    color: hsl(var(--sidebar-foreground));
    transition: background-color var(--transition-default), border-color var(--transition-default), color var(--transition-default);
    text-decoration: none;
  }
  .sidebar-donate-link:hover {
    background: hsl(var(--sidebar-accent));
    color: hsl(var(--sidebar-foreground));
    border-color: hsl(var(--sidebar-border));
  }
  .sidebar-donate-link:focus-visible {
    outline: none;
    box-shadow: var(--focus-ring-sidebar);
  }
  .sidebar-donate-link-icon {
    width: var(--text-nav);
    height: var(--text-nav);
    flex-shrink: 0;
    color: hsl(38 92% 50%);
  }
  .light .sidebar-donate-link-icon {
    color: hsl(38 92% 40%);
  }

  /* Mobile: touch targets (44px min), safe-area for notched devices, overlay above content */
  @media (max-width: 767px) {
    .app-sidebar.sidebar-collapsed {
      padding-left: env(safe-area-inset-left);
    }
  }

  /* macOS-style glass sidebar on desktop: one block using --glass-edge, --glass-highlight-color */
  html.desktop .app-sidebar {
    background: hsl(var(--sidebar-background) / 0.42);
    backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
    -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
    border-right: 1px solid hsl(var(--glass-edge));
    box-shadow: inset 1px 0 0 0 hsl(var(--glass-highlight-color));
  }
  html.desktop.light .app-sidebar {
    background: hsl(var(--sidebar-background) / 0.5);
  }
  html.desktop.deep-dark .app-sidebar {
    background: hsl(var(--sidebar-background) / 0.5);
  }

  /* Reusable Liquid Glass surface (e.g. cards, panels in desktop app) */
  .glass-surface {
    background: hsl(var(--background) / 0.7);
    backdrop-filter: blur(var(--glass-blur-subtle)) saturate(var(--glass-saturate-subtle));
    -webkit-backdrop-filter: blur(var(--glass-blur-subtle)) saturate(var(--glass-saturate-subtle));
    border: 1px solid hsl(var(--border) / 0.6);
  }
  .light .glass-surface {
    background: hsl(var(--background) / 0.75);
    border-color: hsl(var(--border) / 0.7);
  }
  .deep-dark .glass-surface {
    background: hsl(var(--background) / 0.75);
    border-color: hsl(var(--border) / 0.5);
  }

  .prose-markdown {
    @apply text-sm leading-relaxed;
    color: hsl(var(--foreground));
  }

  .prose-markdown h1, .prose-markdown h2, .prose-markdown h3 {
    @apply font-semibold mt-6 mb-3;
    color: hsl(var(--foreground));
  }
  .prose-markdown h1 { @apply text-2xl; }
  .prose-markdown h2 { @apply text-xl; }
  .prose-markdown h3 { @apply text-lg; }
  .prose-markdown p { @apply mb-3; }
  .prose-markdown code {
    @apply px-2 py-1 rounded-md text-sm font-mono;
    background: hsl(var(--code-bg));
    color: hsl(var(--code-text));
  }
  .prose-markdown pre {
    @apply p-4 rounded-lg my-3 overflow-auto;
    background: hsl(var(--code-bg));
  }
  .prose-markdown pre code {
    @apply p-0 bg-transparent;
  }
  .prose-markdown ul, .prose-markdown ol {
    @apply ml-5 mb-3;
  }
  .prose-markdown ul { @apply list-disc; }
  .prose-markdown ol { @apply list-decimal; }
  .prose-markdown li { @apply mb-1; }
  .prose-markdown blockquote {
    @apply border-l-4 pl-4 italic my-3;
    border-color: hsl(var(--primary));
    color: hsl(var(--muted-foreground));
  }
  .prose-markdown a {
    color: hsl(var(--primary));
    @apply underline;
  }
  .prose-markdown table {
    @apply w-full border-collapse my-3;
  }
  .prose-markdown th, .prose-markdown td {
    @apply border px-3 py-2 text-left text-sm;
  }
  .prose-markdown hr {
    @apply my-6;
    border-color: hsl(var(--border));
  }

  /* Touch target utility (mobile a11y) */
  .min-h-touch {
    min-height: var(--min-touch);
  }

  /* Home hub: layout – max-width, center, 8px grid, safe-area (notched devices) */
  .home-main {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  .home-page-pad {
    width: 100%;
    max-width: var(--home-content-max-width);
    margin-inline: auto;
    padding: var(--home-space-md) var(--home-space-lg);
    padding-top: max(var(--home-space-md), env(safe-area-inset-top));
    padding-bottom: max(var(--home-space-md), env(safe-area-inset-bottom));
  }
  @media (min-width: 768px) {
    .home-page-pad {
      padding-left: var(--home-space-xl);
      padding-right: var(--home-space-xl);
      padding-top: max(var(--home-space-lg), env(safe-area-inset-top));
      padding-bottom: max(var(--home-space-lg), env(safe-area-inset-bottom));
    }
  }

  .home-content {
    gap: var(--home-content-gap);
  }
  @media (max-width: 639px) {
    .home-content {
      gap: var(--home-space-md);
    }
  }

  /* Hero: section title typography (industry page/section title) */
  .home-hero {
    display: flex;
    flex-direction: column;
    gap: var(--home-space-md);
  }
  .home-hero-tagline {
    font-size: var(--text-hero);
    font-weight: 600;
    letter-spacing: -0.01em;
    line-height: 1.4;
    max-width: 42rem;
    margin: 0;
    color: hsl(var(--foreground));
  }

  /* Intro card: glass on desktop (frontend-ui-dark-ts glass-card), macOS radius */
  .home-intro {
    margin: 0;
    padding: var(--home-space-md) !important;
    border-radius: var(--home-radius-card);
    border: 1px solid hsl(var(--border));
    background: hsl(var(--card));
  }
  .home-intro .panel-header-label {
    margin: 0 0 var(--home-space-sm);
    font-size: var(--text-ui);
    font-weight: 600;
    letter-spacing: 0.02em;
    color: hsl(var(--foreground));
  }
  .home-intro p,
  .home-intro .space-y-2 {
    font-size: var(--text-content);
    color: hsl(var(--muted-foreground));
    line-height: 1.5;
  }
  html.desktop .home-intro {
    background: hsl(var(--card) / 0.85);
    backdrop-filter: blur(var(--glass-blur-subtle)) saturate(var(--glass-saturate-subtle));
    -webkit-backdrop-filter: blur(var(--glass-blur-subtle)) saturate(var(--glass-saturate-subtle));
    border-color: hsl(var(--border) / 0.8);
  }

  /* Section labels: uppercase, muted (macOS-style group headers) */
  .home-section-label {
    font-size: var(--text-caption);
    font-weight: 600;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    color: hsl(var(--muted-foreground));
    margin: 0 0 var(--home-space-sm);
  }
  .home-tools-header-margin {
    margin-left: calc(-1 * var(--home-space-lg));
    margin-right: calc(-1 * var(--home-space-lg));
    margin-bottom: var(--home-tools-header-gap);
    padding-left: var(--home-space-lg);
    padding-right: var(--home-space-lg);
  }
  @media (min-width: 768px) {
    .home-tools-header-margin {
      margin-left: calc(-1 * var(--home-space-xl));
      margin-right: calc(-1 * var(--home-space-xl));
      padding-left: var(--home-space-xl);
      padding-right: var(--home-space-xl);
    }
  }

  /* Tool cards: fixed height, inner spacing from system scale */
  .home-tool-card {
    height: var(--home-card-height);
    min-height: var(--home-card-height);
    display: flex;
    flex-direction: column;
    padding: var(--home-space-md);
    border-radius: var(--home-radius-card);
    box-sizing: border-box;
  }
  .home-tool-card .home-tool-card-icon {
    margin-bottom: var(--home-space-sm);
  }
  .home-tool-card .home-tool-card-title {
    font-size: var(--text-content);
    font-weight: 600;
    margin-bottom: var(--home-space-xs);
  }
  .home-tool-card .home-tool-card-desc {
    font-size: var(--text-nav);
    flex: 1;
    min-height: 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    color: hsl(var(--muted-foreground));
  }

  /* Mobile: compact list layout for All tools – icon + title + description */
  @media (max-width: 639px) {
    .home-tools-grid {
      grid-template-columns: 1fr;
      gap: var(--home-space-sm);
    }
    .home-tools-grid .home-tool-card {
      height: auto;
      min-height: var(--min-touch);
      flex-direction: row;
      align-items: flex-start;
      padding: var(--home-space-sm) var(--home-space-md);
      gap: var(--home-space-sm);
    }
    .home-tools-grid .home-tool-card .home-tool-card-icon {
      margin-bottom: 0;
      margin-right: 0;
      flex-shrink: 0;
      width: 2.25rem;
      height: 2.25rem;
    }
    .home-tools-grid .home-tool-card .home-tool-card-title {
      flex: 1;
      min-width: 0;
      margin-bottom: var(--home-space-xs);
      padding-right: 1.75rem;
      -webkit-line-clamp: 1;
      line-clamp: 1;
      font-size: var(--text-nav);
      font-weight: 600;
    }
    .home-tools-grid .home-tool-card .home-tool-card-desc {
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
      flex: 1;
      min-width: 0;
      margin-bottom: 0;
      font-size: var(--text-caption);
      line-height: 1.35;
    }
    .home-tools-grid .home-tool-card > span[aria-hidden] {
      right: var(--home-space-sm);
      top: var(--home-space-sm);
      transform: none;
    }
  }

  /* Recently visited: quick-access strip, left-accent anchor (differentiation), system 8px grid */
  .home-recent-section {
    margin-bottom: 0;
  }
  .home-recent-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--home-space-sm);
    margin-bottom: var(--home-space-sm);
  }
  .home-recent-header .home-section-label {
    margin-bottom: 0;
  }
  .home-recent-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 1.25rem;
    padding: 0.125rem 0.375rem;
    font-size: var(--text-caption);
    font-weight: 600;
    line-height: 1.2;
    color: hsl(var(--muted-foreground) / 0.95);
    letter-spacing: 0.02em;
    border-radius: var(--radius-sm);
    background: hsl(var(--muted) / 0.4);
  }
  /* Recently visited: same grid + list as All tools (.home-tools-grid); only section/header/count styled here */
  @media (max-width: 639px) {
    .home-recent-section {
      margin-top: var(--home-space-xs);
    }
    .home-recent-header {
      margin-bottom: var(--home-space-xs);
      gap: var(--home-space-xs);
    }
    .home-recent-count {
      min-width: var(--text-hero);
      padding: 0.0625rem var(--home-space-xs);
      font-size: var(--text-caption);
    }
  }

  /* Search: full width on mobile, max-width on sm+ */
  .home-tools-search-wrap {
    width: 100%;
    max-width: 28rem;
  }
  .home-tools-search {
    transition: background-color var(--transition-default), border-color var(--transition-default);
  }

  /* Sticky tools header: glass bar (macOS-style), below safe-area when sticky */
  .home-tools-header {
    top: env(safe-area-inset-top);
    padding-top: var(--home-space-md) !important;
    padding-bottom: var(--home-space-md) !important;
  }

  /* Empty states: system padding, body text */
  .home-empty {
    padding: var(--home-space-xl) var(--home-space-lg) !important;
    border-radius: var(--home-radius-card);
    transition: background-color var(--transition-default), border-color var(--transition-default);
  }
  .home-empty p {
    font-size: var(--text-content);
    color: hsl(var(--muted-foreground));
    line-height: 1.5;
  }

  /* Footer: caption typography, separator, safe-area bottom */
  .home-footer {
    margin-top: var(--home-content-gap);
    padding-top: var(--home-footer-padding-y);
    padding-bottom: max(var(--home-footer-padding-y), env(safe-area-inset-bottom));
    border-top: 1px solid hsl(var(--border) / 0.6);
  }
  @media (min-width: 768px) {
    .home-footer {
      padding-top: var(--home-footer-padding-y-md);
      padding-bottom: max(var(--home-footer-padding-y-md), env(safe-area-inset-bottom));
    }
  }
  .home-footer-text {
    margin: 0;
    font-size: var(--text-caption);
    font-weight: 500;
    letter-spacing: 0.02em;
    color: hsl(var(--muted-foreground) / 0.9);
  }

  /* Card stagger (short duration, macOS-like) */
  .home-content .home-tool-card {
    animation: home-card-in 0.22s var(--transition-ease) backwards;
  }

  @keyframes home-card-in {
    from {
      opacity: 0;
      transform: translateY(6px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
}
